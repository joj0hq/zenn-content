---
title: "ã€DDDã€‘Golangã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒ«ã§ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜ã‚’è¡¨ç¾ã—ã¦ã¿ãŸ"
emoji: "ğŸ–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Go","ddd","ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆ","ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£","åˆå¿ƒè€…å‘ã‘"]
published: false
---

# æ¦‚è¦

DDDã«ã¤ã„ã¦ã¯å…ˆäººã®é¬¼ã»ã©ã‚ã‹ã‚Šã‚„ã™ã„æ›¸ç±ãŒã‚ã‚‹ã®ã§ã“ã¡ã‚‰ã‚’èª­ã‚€ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚ï¼ˆç¬‘ï¼‰
ãã‚Œã§ã¯ã€ç‰©å¥½ããªäººã¯èª­ã‚“ã§ã„ã£ã¦ãã ã•ã„ã€‚

## ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆ(DDD)ã¨ã¯ï¼Ÿ

ãã‚‚ãã‚‚ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã¨ã¯ãªã«ã‹ã«ã¤ã„ã¦è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚
[DDD Reference](https://www.domainlanguage.com/ddd/reference/)ã§ã®å®šç¾©ã‚’ä»¥ä¸‹ã«è¨˜ã—ã¾ã™ã€‚

> Domain-Driven Design is an approach to the development of complex software in which we:
>
> 1. Focus on the core domain.
> 2. Explore models in a creative collaboration of domain practitioners and software practitioners.
> 3. Speak a ubiquitous language within an explicitly bounded context.
>
> This three-point summary of DDD depends on the definition of the terms, which are defined in this booklet.
> å‡ºå…¸URLï¼šhttps://www.domainlanguage.com/ddd/reference/

ã“ã¡ã‚‰ã‚’æ—¥æœ¬èªã«æ„è¨³ã™ã‚‹ã¨ã€

> 1.ä¸­æ ¸ã¨ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ç„¦ç‚¹ã‚’å½“ã¦ã‚‹
> 2.ãƒ‰ãƒ¡ã‚¤ãƒ³å°‚é–€å®¶ã¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢å°‚é–€å®¶ã®ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ¢ãƒ‡ãƒ«ã‚’æ¢æ±‚ã™ã‚‹
> 3.å¢ƒç•Œã¥ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ä¸­ã§ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹ãªè¨€èªã‚’è©±ã™

ã¤ã¾ã‚Šã€
```
ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¨å…±ã«å¸¸ã«åŒã˜è¨€èªã§èªè­˜ã‚’åˆã‚ã›ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦å¸¸ã«æ¢æ±‚ã‚’ç¶šã‘ã‚‹ã€‚
ãã—ã¦æœ€çµ‚çš„ã«ãƒ¢ãƒ‡ãƒ«ã¨è¨€èªã‚’ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«ã¾ã§è½ã¨ã—ã“ã‚€ã“ã¨ã‚’ç›®æŒ‡ã™ã€‚
```
ãŒDDDã§ã‚ã‚‹ã¨è¨€ãˆã‚‹ã§ã—ã‚‡ã†ã€‚
(Eric Evansæœ¬äººã‚‚ã€Œæ˜ç¢ºã«å®šç¾©ã™ã‚‹ã®ã¯é›£ã—ã„ã€ã¨è¨€ã£ã¦ã„ãŸã‚Šã™ã‚‹ã®ã§ä¸€æ¦‚ã«å®šç¾©ã™ã‚‹ã®ã¯é›£ã—ã„ã§ã™ãŒã€‚)

## ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨ã¯ï¼Ÿ
ã“ã¡ã‚‰ã‚‚[DDD Reference](https://www.domainlanguage.com/ddd/reference/)ã§å®šç¾©ã•ã‚Œã¦ã„ãŸã®ã§ã€ã“ã¡ã‚‰ã‚’å‚è€ƒã«ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

> A sphere of knowledge, influence, or activity.
The subject area to which the user applies a program is the domain of the software.
çŸ¥è­˜ã€å½±éŸ¿åŠ›ã€ã¾ãŸã¯æ´»å‹•ã®é ˜åŸŸã€‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’é©ç”¨ã™ã‚‹å¯¾è±¡ã‚¨ãƒªã‚¢ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ã‚ã‚‹ã€‚

ã¤ã¾ã‚Šã¯æ¥­å‹™çš„ãªé–¢å¿ƒäº‹ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§èª²é¡Œè§£æ±ºã™ã‚‹å¯¾è±¡ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨å®šç¾©ã—ã¦ã„ã¾ã™ã€‚

## ä¸å¤‰æ¡ä»¶ã¨ã¯ï¼Ÿ
DDDã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ãŒãŠã•ã‚‰ã„ã§ããŸã¨ã“ã‚ã§ã€æ¬¡ã«æ¥­å‹™ä¸Šã®åˆ¶ç´„ã‚’è€ƒãˆã‚‹ä¸Šã§ã€ä¸å¤‰æ¡ä»¶ã«è§¦ã‚Œã¦ã„ãã¾ã—ã‚‡ã†ã€‚
ä¸å¤‰æ¡ä»¶ã¨ã¯ã€ãƒ¢ãƒ‡ãƒ«ãŒæœ‰åŠ¹ã§ã‚ã‚‹æœŸé–“ä¸­ã«ã€å¸¸ã«ä¸€è²«ã—ã¦ã„ã‚‹å¿…è¦ã®ã‚ã‚‹çŠ¶æ…‹ã‚’æŒ‡ã—ã¾ã™ã€‚
ä¾‹ãˆã°ã€TODOãƒªã‚¹ãƒˆã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¾‹ã«ã¨ã£ã¦ã¿ã¾ã™ã€‚
è¦ä»¶å®šç¾©ã‚’è¡Œã£ãŸã¨ã“ã‚ã€ä»¥ä¸‹ã®æ™®éæ¡ä»¶ã‚’æº€ãŸã™å¿…è¦ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚

- ã‚¿ã‚¹ã‚¯ã¯å¿…ãšåç§°ã¨æœŸæ—¥ã¨å„ªå…ˆåº¦ã‚’æŒã¤
- ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã™ã‚‹ã¨æœªå®Œäº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¨ãªã‚‹
- ã‚¿ã‚¹ã‚¯ã¯å®Œäº†ã—ãŸã‚‰å®Œäº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¨ãªã‚Šã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æˆ»ã›ãªã„
- ã‚¿ã‚¹ã‚¯ã¯5å›ã ã‘ã€1æ—¥ãšã¤å»¶æœŸã§ãã‚‹
- ã‚¿ã‚¹ã‚¯åã¯å¤‰æ›´ã§ããªã„
- ã‚¿ã‚¹ã‚¯ã®å„ªå…ˆåº¦ã¯1åº¦ã ã‘å¤‰æ›´ã§ãã‚‹

ã§ã¯ã€ã“ã®ä¸å¤‰æ¡ä»¶ã‚’ä½¿ã£ã¦æ¬¡ã«å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã¸è½ã¨ã—è¾¼ã‚“ã§ã„ãã¾ã™ã€‚

# [å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³]ãƒ‰ãƒ¡ã‚¤ãƒ³ã®çŸ¥è­˜ã‚’è¡¨ç¾ã—ã¦ã„ãªã„ãƒ¢ãƒ‡ãƒ«

```go
type task struct {
	id            string
	taskStatus    TaskStatus
	name          string
	dueDate       time.Time
	postponeCount int64
}

func NewTask() *task {
	return &task{}
}

const POSTPONE_MAX_COUNT = 3

type TaskStatus string

const (
	TaskStatusDoing TaskStatus = "doing"
	TaskStatusDone  TaskStatus = "done"
)

// setter
func (t *task) SetID(id string) {
	t.id = id
}
func (t *task) SetTaskStatus(taskStatus TaskStatus) {
	t.taskStatus = taskStatus
}
func (t *task) SetName(name string) {
	t.name = name
}
func (t *task) SetDueDate(dueDate time.Time) {
	t.dueDate = dueDate
}
func (t *task) SetPostponeCount(postponeCount int64) {
	t.postponeCount = postponeCount
}

// getter
func (t *task) GetID() string {
	return t.id
}
func (t *task) GetName() string {
	return t.name
}
func (t *task) GetTaskStatus() TaskStatus {
	return t.taskStatus
}
func (t *task) GetDueDate() time.Time {
	return t.dueDate
}
func (t *task) GetPostponeCount() int64 {
	return t.postponeCount
}

func (t *task) CanPostpone() bool {
	return t.postponeCount < POSTPONE_MAX_COUNT
}
```

```go
type TaskApplication struct {
	ctx      context.Context
	taskRepo repository.TaskRepository
}

func (s *TaskApplication) CreateTask(name string, dueDate time.Time) error {
	if name == "" || dueDate.IsZero() {
		return errors.New("å¿…é ˆé …ç›®ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
	}
	task := domain.NewTask()
	task.SetTaskStatus(domain.TaskStatusDoing)
	task.SetName(name)
	task.SetDueDate(dueDate)
	task.SetPostponeCount(0)
	if err := s.taskRepo.Save(ctx, task); err != nil {
		return err
	}
	return nil
}

func (s *TaskApplication) PostponeTask(taskID string) error {
	task, err := s.taskRepo.GetByID(ctx, taskID)
	if err != nil {
		return err
	}
	if !task.CanPostpone() {
		return errors.New("æœ€å¤§å»¶é•·å›æ•°ã‚’è¶…éã—ã¦ã„ã¾ã™ã€‚")
	}
	task.SetDueDate(task.GetDueDate().Add(24 * time.Hour))
	task.SetPostponeCount(task.GetPostponeCount() + 1)
	if err := s.taskRepo.Save(ctx, task); err != nil {
		return err
	}
	return nil
}
```

```go
func (s *TaskApplication) CreateDoneTask(taskID, name string, dueDate time.Time, taskStatus domain.TaskStatus) error {
	task := domain.NewTask()
	task.SetTaskStatus(domain.TaskStatusDone) // å®Œäº†è‡ªä½“ã§ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ
	task.SetPostponeCount(-1)                 // ã‚«ã‚¦ãƒ³ãƒˆã«ãƒã‚¤ãƒŠã‚¹ã‚’è¨­å®š
	if err := s.taskRepo.Save(ctx, task); err != nil {
		return err
	}
	return nil
}

func (s *TaskApplication) ChangeTask(taskID, name string, dueDate time.Time, taskStatus domain.TaskStatus) error {
	task := domain.NewTask()
	task.SetName(name)             // å¤‰æ›´ã—ã¦ã¯è¡Œã‘ãªã„ã‚¿ã‚¹ã‚¯åã‚’å¤‰æ›´
	task.SetDueDate(dueDate)       // å‹æ‰‹ã«æœŸæ—¥ã‚’å…¥åŠ›å€¤ã§è¨­å®šã€å»¶é•·å›æ•°ã‚‚ç„¡è¦–
	task.SetTaskStatus(taskStatus) // ã‚¿ã‚¹ã‚¯ã‚’æœªå®Œäº†ã«æˆ»ã›ã¦ã—ã¾ã†
	if err := s.taskRepo.Save(ctx, task); err != nil {
		return err
	}
	return nil
}
```

# [æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³]ãƒ‰ãƒ¡ã‚¤ãƒ³ã®çŸ¥è­˜ã‚’è¡¨ç¾ã—ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«

```go
type task struct {
	id            string
	taskStatus    TaskStatus
	name          string
	dueDate       time.Time
	postponeCount int64
}

const POSTPONE_MAX_COUNT = 3

type TaskStatus string

const (
	TaskStatusDoing TaskStatus = "doing"
	TaskStatusDone  TaskStatus = "done"
)

// ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ä½œæˆæ™‚ã®ä¸å¤‰æ¡ä»¶ã‚’è¡¨ç¾ã™ã‚‹
func NewTask(name string, dueDate time.Time) (*task, error) {
	if name == "" || dueDate.IsZero() {
		return nil, errors.New("å¿…é ˆé …ç›®ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
	}
	return &task{
		taskStatus:    TaskStatusDoing,
		name:          name,
		dueDate:       dueDate,
		postponeCount: 0,
	}, nil
}

// ä½œæˆæ¸ˆã¿ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®çŠ¶æ…‹é·ç§»ã«é–¢ã™ã‚‹ä¸å¤‰æ¡ä»¶ã‚’è¡¨ç¾ã™ã‚‹
func (t *task) Postpone() (*task, error) {
	if !t.CanPostpone() {
		return nil, errors.New("æœ€å¤§å»¶é•·å›æ•°ã‚’è¶…éã—ã¦ã„ã¾ã™ã€‚")
	}
	t.dueDate.Add(24 * time.Hour)
	t.postponeCount++
	return t, nil
}

func (t *task) Done() {
	t.taskStatus = TaskStatusDone
}

// nameã®setterã¯å­˜åœ¨ã—ãªã„ã®ã§ã€nameã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã¯ã§ããªã„

// getter
func (t *task) GetID() string {
	return t.id
}
func (t *task) GetName() string {
	return t.name
}
func (t *task) GetDueDate() time.Time {
	return t.dueDate
}

func (t *task) IsDoing() bool {
	return t.taskStatus == TaskStatusDoing
}
func (t *task) CanPostpone() bool {
	return t.postponeCount < POSTPONE_MAX_COUNT
}
```

```go
type TaskApplication struct {
	ctx      context.Context
	taskRepo repository.TaskRepository
}

func (s *TaskApplication) CreateTask(name string, dueDate time.Time) error {
	task, err := domain.NewTask(name, dueDate)
	if err != nil {
		return err
	}
	if err := s.taskRepo.Save(ctx, task); err != nil {
		return err
	}
	return nil
}

func (s *TaskApplication) PostponeTask(taskID string) error {
	task, err := s.taskRepo.GetByID(ctx, taskID)
	if err != nil {
		return err
	}
	postponedTask, err := task.Postpone()
	if err != nil {
		return err
	}
	if err := s.taskRepo.Save(ctx, postponedTask); err != nil {
		return err
	}
	return nil
}
```

# å®šç¾©ã®æŒ¯ã‚Šè¿”ã‚Š
